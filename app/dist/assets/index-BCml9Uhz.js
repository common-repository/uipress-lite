import{e as O,o as u,g as a,t as s,y as o,z as f,q as c,B as l,C as m,a0 as d,f as h}from"./index-eeS_Y43W.js";import{_ as b}from"./index-DJ_q6T8N.js";const{__:e}=wp.i18n,k={components:{Tabs:b},props:{args:Object,triggerClass:String},data(){return{modelOpen:!0,themeLoading:!1,themes:[],saving:!1,finished:!1,importPath:"",fetchingSettings:!0,strings:{siteSync:e("Site sync","uipress-lite"),hostExplanation:e("Enabling this site as a host allows you to sync other sites to this site's uiPress settings.","uipress-lite"),pathExplanation:e("This is the path to the current sites sync endpoint","uipress-lite"),keyExplanation:e("This is the key used to securely sync between sites","uipress-lite"),settingsExplanation:e("Choose the sections you want to sync with a remote site. Enabling auto update will allow uiPress to routinely check for changes at the host site and sync updates.","uipress-lite"),syncExplanation:e("Choose what areas of uiPress you want to keep in sync","uipress-lite"),syncEndpointExplanation:e("This is the endpoint url to the site you want to sync with","uipress-lite"),autoUpdateExplanation:e("If enabled, uipress will periodically check for updates and keep this site in sync","uipress-lite"),templates:e("Templates","uipress-lite"),siteSettings:e("Site settings","uipress-lite"),themeStyles:e("Theme styles","uipress-lite"),adminMenus:e("Admin menus","uipress-lite"),cancel:e("Cancel","uipress-lite"),export:e("Export","uipress-lite"),hostEnabled:e("Host enabled","uipress-lite"),importPath:e("Import URL","uipress-lite"),importKey:e("Import key","uipress-lite"),save:e("Save","uipress-lite"),refreshKey:e("Refresh key","uipress-lite"),syncOptions:e("Sync options","uipress-lite"),autoUpdate:e("Auto update","uipress-lite"),syncNow:e("Sync now","uipress-lite")},hostOptions:{hostEnabled:!1,key:""},syncOptions:{importOptions:{templates:!0,siteSettings:!0,themeStyles:!0,adminMenus:!0},key:"",path:"",keepUpToDate:!1},activeTab:"host",switchOptions:{host:{value:"host",label:e("Host","uipress-lite")},sync:{value:"sync",label:e("Sync","uipress-lite")}}}},watch:{currentStep:{handler(p,t){p==2&&this.fetchThemes()}}},created(){this.getSyncOptions()},computed:{isDisabledButton(){if(!this.syncOptions.importOptions.templates&&!this.syncOptions.importOptions.siteSettings&&!this.syncOptions.importOptions.themeStyles&&!this.syncOptions.importOptions.adminMenus)return!0}},methods:{async getSyncOptions(){let p=new FormData;p.append("action","uip_get_sync_options"),p.append("security",uip_ajax.security);const t=await this.sendServerRequest(uip_ajax.ajax_url,p);if(this.fetchingSettings=!1,t.error){this.uipApp.notifications.notify(t.message,"","error",!0);return}this.importPath=t.restURL,t.options&&("key"in t.options&&(this.hostOptions.key=t.options.key),"hostEnabled"in t.options&&(this.hostOptions.hostEnabled=t.options.hostEnabled),"syncOptions"in t.options&&("importOptions"in t.options.syncOptions&&(this.syncOptions.importOptions={...this.syncOptions.importOptions,...t.options.syncOptions.importOptions}),"key"in t.options.syncOptions&&(this.syncOptions.key=t.options.syncOptions.key),"keepUpToDate"in t.options.syncOptions&&(this.syncOptions.keepUpToDate=t.options.syncOptions.keepUpToDate),"path"in t.options.syncOptions&&(this.syncOptions.path=t.options.syncOptions.path)))},async refreshKey(){let p=new FormData;p.append("action","uip_refresh_sync_key"),p.append("security",uip_ajax.security);const t=await this.sendServerRequest(uip_ajax.ajax_url,p);if(this.fetchingSettings=!1,t.error){this.uipApp.notifications.notify(t.message,"","error",!0);return}t.options&&"key"in t.options&&(this.hostOptions.key=t.options.key)},async saveHostSettings(){let p=new FormData;p.append("action","uip_save_sync_options"),p.append("security",uip_ajax.security),p.append("options",this.prepareJSON(this.hostOptions)),p.append("syncOptions",this.prepareJSON(this.syncOptions));const t=await this.sendServerRequest(uip_ajax.ajax_url,p);if(this.fetchingSettings=!1,t.error){this.uipApp.notifications.notify(t.message,"","error",!0);return}this.uipApp.notifications.notify(e("Settings saved","uipress-lite"),"","success")},async syncNow(){let p=new FormData;p.append("action","uip_start_site_sync"),p.append("security",uip_ajax.security),p.append("options",JSON.stringify(this.syncOptions));const t=this.uipApp.notifications.notify(e("Importing uiPress content","uipress-lite"),"","default",!1,!0),y=await this.sendServerRequest(uip_ajax.ajax_url,p);if(this.uipApp.notifications.remove(t),y.error){this.uipApp.notifications.notify(y.message,"","error",!0);return}this.uipApp.notifications.notify(e("Import complete","uipress-lite"),"","success"),this.$router.push("/"),setTimeout(function(){location.reload()},600)}}},w={class:"uip-flex uip-flex-column uip-row-gap-s uip-padding-top-s uip-w-100p"},S={class:"uip-flex uip-flex-between uip-gap-xs uip-flex-center"},E={class:"uip-text-l uip-text-emphasis"},T={key:1,class:"uip-flex uip-gap-xs"},D=["disabled"],U={key:0,class:"uip-padding-l uip-flex uip-flex-center uip-flex-middle"},V={key:1,class:"uip-grid-col-4-6 uip-padding-left-xs",style:{"grid-gap":"var(--uip-margin-m)"}},j={class:"uip-flex uip-flex-column uip-gap-xxs"},A={class:"uip-text-emphasis"},C={class:"uip-text-muted"},N={class:"uip-flex uip-gap-xs uip-flex-no-wrap uip-flex-center"},P=s("div",{class:"uip-border-top",style:{"grid-column":"span 2 / span 2"}},null,-1),I={class:"uip-flex uip-flex-column uip-gap-xxs"},M={class:"uip-text-emphasis"},K={class:"uip-text-muted"},R={class:"uip-flex uip-gap-xs uip-flex-no-wrap uip-flex-center"},B=["value"],q=s("div",{class:"uip-border-top",style:{"grid-column":"span 2 / span 2"}},null,-1),H={class:"uip-flex uip-flex-column uip-gap-xxs"},F={class:"uip-text-emphasis"},J={class:"uip-text-muted"},L={class:"uip-flex uip-gap-xxs uip-flex-no-wrap uip-flex-center"},z=["title"],G=s("div",{class:"uip-border-top",style:{"grid-column":"span 2 / span 2"}},null,-1),Q={key:2,class:"uip-grid-col-4-6 uip-padding-left-xs",style:{"grid-gap":"var(--uip-margin-m)"}},W={class:"uip-flex uip-flex-column uip-gap-xxs"},X={class:"uip-text-emphasis"},Y={class:"uip-text-muted"},Z={class:"uip-flex uip-gap-xs uip-flex-no-wrap uip-flex-center"},$=s("div",{class:"uip-border-top",style:{"grid-column":"span 2 / span 2"}},null,-1),ss={class:"uip-flex uip-flex-column uip-gap-xxs"},ts={class:"uip-text-emphasis"},is={class:"uip-text-muted"},es={class:"uip-flex uip-gap-xxs uip-flex-no-wrap uip-flex-center"},ns=s("div",{class:"uip-border-top",style:{"grid-column":"span 2 / span 2"}},null,-1),os={class:"uip-flex uip-flex-column uip-gap-xxs"},ps={class:"uip-text-emphasis"},ls={class:"uip-text-muted"},us={class:"uip-flex uip-flex-column uip-row-gap-xs"},as={class:"uip-flex uip-gap-xs uip-flex-center"},rs={class:""},cs={class:"uip-flex uip-gap-xs uip-flex-center"},ds={class:""},hs={class:"uip-flex uip-gap-xs uip-flex-center"},ys={class:""},ms={class:"uip-flex uip-gap-xs uip-flex-center"},xs={class:""},fs=s("div",{class:"uip-border-top",style:{"grid-column":"span 2 / span 2"}},null,-1),_s={class:"uip-flex uip-flex-column uip-gap-xxs"},gs={class:"uip-text-emphasis"},vs={class:"uip-text-muted"},Os={class:"uip-flex uip-gap-xs uip-flex-no-wrap uip-flex-center"},bs=s("div",{class:"uip-border-top",style:{"grid-column":"span 2 / span 2"}},null,-1);function ks(p,t,y,ws,i,r){const _=h("Tabs"),g=h("loading-chart"),x=h("switch-select"),v=h("AppIcon");return u(),a("div",w,[s("div",S,[s("div",E,o(i.strings.siteSync),1),i.activeTab=="host"?(u(),a("button",{key:0,onClick:t[0]||(t[0]=n=>r.saveHostSettings()),class:"uip-button-primary"},o(i.strings.save),1)):f("",!0),i.activeTab!="host"?(u(),a("div",T,[s("button",{onClick:t[1]||(t[1]=n=>r.syncNow()),class:"uip-button-secondary"},o(i.strings.syncNow),1),s("button",{onClick:t[2]||(t[2]=n=>r.saveHostSettings()),class:"uip-button-primary",disabled:r.isDisabledButton},o(i.strings.save),9,D)])):f("",!0)]),c(_,{options:i.switchOptions,modelValue:i.activeTab,"onUpdate:modelValue":t[3]||(t[3]=n=>i.activeTab=n),class:"uip-margin-bottom-s"},null,8,["options","modelValue"]),i.fetchingSettings?(u(),a("div",U,[c(g)])):i.activeTab=="host"?(u(),a("div",V,[s("div",j,[s("span",A,o(i.strings.hostEnabled),1),s("div",C,o(i.strings.hostExplanation),1)]),s("div",N,[c(x,{args:{asText:!0},value:i.hostOptions.hostEnabled,returnData:function(n){i.hostOptions.hostEnabled=n}},null,8,["value","returnData"])]),P,s("div",I,[s("span",M,o(i.strings.importPath),1),s("div",K,o(i.strings.pathExplanation),1)]),s("div",R,[s("input",{value:i.importPath,class:"uip-input-small uip-w-100p",disabled:"",type:"text"},null,8,B)]),q,s("div",H,[s("span",F,o(i.strings.importKey),1),s("div",J,o(i.strings.keyExplanation),1)]),s("div",L,[l(s("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>i.hostOptions.key=n),disabled:"",class:"uip-input-small uip-w-100p",type:"text"},null,512),[[m,i.hostOptions.key]]),s("button",{onClick:t[5]||(t[5]=n=>r.refreshKey()),title:i.strings.refreshKey,class:"uip-button-default uip-border-rounder uip-icon uip-padding-xxs uip-link-muted uip-margin-left-xs"},[c(v,{icon:"refresh"})],8,z)]),G])):(u(),a("div",Q,[s("div",W,[s("span",X,o(i.strings.importPath),1),s("div",Y,o(i.strings.syncEndpointExplanation),1)]),s("div",Z,[l(s("input",{"onUpdate:modelValue":t[6]||(t[6]=n=>i.syncOptions.path=n),class:"uip-input-small uip-w-100p",type:"text"},null,512),[[m,i.syncOptions.path]])]),$,s("div",ss,[s("span",ts,o(i.strings.importKey),1),s("div",is,o(i.strings.keyExplanation),1)]),s("div",es,[l(s("input",{"onUpdate:modelValue":t[7]||(t[7]=n=>i.syncOptions.key=n),class:"uip-input-small uip-w-100p",type:"password"},null,512),[[m,i.syncOptions.key]])]),ns,s("div",os,[s("span",ps,o(i.strings.syncOptions),1),s("div",ls,o(i.strings.syncExplanation),1)]),s("div",us,[s("label",as,[l(s("input",{class:"uip-user-check uip-checkbox uip-margin-remove","onUpdate:modelValue":t[8]||(t[8]=n=>i.syncOptions.importOptions.templates=n),type:"checkbox"},null,512),[[d,i.syncOptions.importOptions.templates]]),s("div",rs,o(i.strings.templates),1)]),s("label",cs,[l(s("input",{class:"uip-user-check uip-checkbox uip-margin-remove","onUpdate:modelValue":t[9]||(t[9]=n=>i.syncOptions.importOptions.siteSettings=n),type:"checkbox"},null,512),[[d,i.syncOptions.importOptions.siteSettings]]),s("div",ds,o(i.strings.siteSettings),1)]),s("label",hs,[l(s("input",{class:"uip-user-check uip-checkbox uip-margin-remove","onUpdate:modelValue":t[10]||(t[10]=n=>i.syncOptions.importOptions.themeStyles=n),type:"checkbox"},null,512),[[d,i.syncOptions.importOptions.themeStyles]]),s("div",ys,o(i.strings.themeStyles),1)]),s("label",ms,[l(s("input",{class:"uip-user-check uip-checkbox uip-margin-remove","onUpdate:modelValue":t[11]||(t[11]=n=>i.syncOptions.importOptions.adminMenus=n),type:"checkbox"},null,512),[[d,i.syncOptions.importOptions.adminMenus]]),s("div",xs,o(i.strings.adminMenus),1)])]),fs,s("div",_s,[s("span",gs,o(i.strings.autoUpdate),1),s("div",vs,o(i.strings.autoUpdateExplanation),1)]),s("div",Os,[c(x,{args:{asText:!0},value:i.syncOptions.keepUpToDate,returnData:function(n){i.syncOptions.keepUpToDate=n}},null,8,["value","returnData"])]),bs]))])}const Ts=O(k,[["render",ks]]);export{Ts as default};
