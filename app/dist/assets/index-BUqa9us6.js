import{b as u,w as A,o as p,g as c,q as S,k as d,j as M,m as j,F as g,f as B,t as e,y as t,D as T,l as F,u as l,z as x,a4 as V,E as G,Z as W}from"./index-eeS_Y43W.js";import{u as z}from"../builder.build.js";import{_ as H}from"./index-DoKlNfWz.js";const I={class:"inline-flex uip-text-muted"},J={class:"uip-max-w-200 uip-overflow-hidden uip-text-ellipsis uip-no-wrap"},O={class:"inline-flex uip-text-muted"},R={class:"uip-flex uip-flex-column uip-gap-s"},U={class:"grid grid-cols-6 gap-4"},X={class:"uip-text-muted"},q={class:"col-span-5 flex flex-row place-content-between"},Z=e("div",{class:"uip-border-top col-span-6"},null,-1),K={class:"uip-text-muted"},Q={class:"col-span-5"},Y=e("div",{class:"uip-border-top col-span-6"},null,-1),ee={class:"uip-text-muted"},te={class:"col-span-5"},se=e("div",{class:"uip-border-top col-span-6"},null,-1),ae={class:"uip-text-muted"},ie={class:"col-span-5"},oe=e("div",{class:"uip-border-top col-span-6"},null,-1),ne={class:"uip-text-muted"},re={class:"col-span-5"},le=e("div",{class:"uip-border-top col-span-6"},null,-1),ue={class:"uip-text-muted"},pe={class:"col-span-5"},ce=["innerHTML"],de=e("div",{class:"uip-border-top col-span-6"},null,-1),_e={class:"uip-text-muted"},ve={class:"col-span-5 uip-flex uip-flex-column uip-gap-s"},ge=e("div",{class:"uip-border-top col-span-6"},null,-1),ye={__name:"index",setup(fe){const{__:s}=wp.i18n,f=u([]),a=u(null),y=u(null),m=u(!0);u(null),z();const{appContext:N}=W(),n=u({search:"",per_page:15,page:1,total:0,pages:0,status:"any",context:"edit"}),C=u([{key:"time",label:s("Time","uipress-lite")},{key:"status",label:s("Status","uipress-lite")},{key:"message",label:s("Message","uipress-lite")},{key:"date",label:s("Date","uipress-lite")}]),_=async o=>{const{uipApp:r}=N.config.globalProperties;m.value=!0;const{per_page:h,search:i,page:w}=n.value,$=`${uip_ajax.rest_url}uipress/v1/errorlog?per_page=${h}&search=${i}&page=${w}`,v=await fetch($,{method:"GET",headers:uip_ajax.rest_headers});if(m.value=!1,!v.ok){r.notifications.notify(s("Unable to fetch error list right now"),"","error",!0);return}const k=await v.json();if(v.error){r.notifications.notify(s("Unable to fetch error list right now"),"","error",!0);return}n.value.total=v.headers.get("X-WP-Total"),n.value.pages=v.headers.get("X-WP-TotalPages"),console.log(k),f.value=k},E=o=>{try{return JSON.stringify(JSON.parse(o),void 0,2)}catch{return o}},P=()=>{n.value.page>1&&(n.value.page--,_())},D=()=>{n.value.page<n.value.pages&&(n.value.page++,_())},L=(o,r)=>{a.value=f.value[r],a.value&&y.value.show()},b=o=>o=="MESSAGE"?"uip-border-green uip-text-green":o=="FATAL"?"uip-border-red uip-text-red":o=="WARNING"?"uip-border-orange uip-text-orange":"uip-border uip-text-muted";return A(()=>n.value.search,(o,r)=>{!o&&r&&_()}),_(),(o,r)=>{const h=B("uip-offcanvas");return p(),c(g,null,[S(H,{pagination:n.value,columns:C.value,data:f.value,fetching:m.value,onPrevious:P,onNext:D,onSearch:r[0]||(r[0]=i=>_()),rowClick:L,hideSelect:!0},{"row-time":d(({row:i})=>[e("div",I,"@"+t(i.time),1)]),"row-status":d(({row:i})=>[e("div",{class:T(["uip-inline-flex uip-text-s uip-padding-left-xxs uip-padding-right-xxs uip-border uip-border-round uip-font-mono",b(i.type)])},t(i.type),3)]),"row-message":d(({row:i})=>[e("div",J,t(i.message),1)]),"row-date":d(({row:i})=>[e("div",O,t(i.date),1)]),_:1},8,["pagination","columns","data","fetching"]),(p(),M(j("style"),null,{default:d(()=>[F(" .gap-4 { gap: 1rem; } .grid-cols-6 { grid-template-columns: repeat(6, minmax(0px, 1fr)); } .grid { display: grid; }.col-span-5 { grid-column: span 5 / span 5; } .col-span-6 { grid-column: span 6 / span 6; } .text-pretty { text-wrap: pretty; }")]),_:1})),S(h,{ref_key:"offcanvas",ref:y,style:{width:"560px"}},{content:d(()=>[e("div",R,[e("div",U,[e("div",X,t(l(s)("Status","uipress-lite")),1),e("div",q,[e("div",{class:T(["uip-inline-flex uip-text-s uip-padding-left-xxs uip-padding-right-xxs uip-border uip-border-round uip-font-mono",b(a.value.type)])},t(a.value.type),3)]),Z,a.value.file?(p(),c(g,{key:0},[e("div",K,[e("div",null,t(l(s)("File","uipress-lite")),1)]),e("div",Q,t(a.value.file),1),Y],64)):x("",!0),a.value.line?(p(),c(g,{key:1},[e("div",ee,t(l(s)("Line","uipress-lite")),1),e("div",te,"@"+t(a.value.line),1),se],64)):x("",!0),e("div",ae,t(l(s)("Date","uipress-lite")),1),e("div",ie,t(l(V)(a.value.date)),1),oe,e("div",ne,t(l(s)("Time","uipress-lite")),1),e("div",re,"@"+t(a.value.time),1),le,e("div",ue,[e("div",null,t(l(s)("Message","uipress-lite")),1)]),e("div",pe,[e("pre",{innerHTML:E(a.value.message),class:"text-pretty",style:{margin:"0"}},null,8,ce)]),de,a.value.stackTrace.length?(p(),c(g,{key:2},[e("div",_e,[e("div",null,t(l(s)("Stack trace","uipress-lite")),1)]),e("div",ve,[(p(!0),c(g,null,G(a.value.stackTrace,(i,w)=>(p(),c("div",null,t(i),1))),256))]),ge],64)):x("",!0)])])]),_:1},512)],64)}}};export{ye as default};
