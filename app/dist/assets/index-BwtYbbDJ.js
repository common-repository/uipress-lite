import{b as l,c as A,o as m,g as _,q as c,k as p,F as b,X as h,f as k,t as s,y as u,u as v,D as B,x as W,E as X,j as Y,Y as Z,Z as G}from"./index-eeS_Y43W.js";import{u as H}from"../builder.build.js";import{_ as J}from"./index-DoKlNfWz.js";const K={class:"uip-flex uip-flex-column uip-gap-s uip-padding-l uip-flex-center"},O={class:"uip-text-bold uip-text-xl uip-text-emphasis"},Q={class:"uip-text-muted"},ee={class:"inline-flex uip-text-emphasis"},te={class:"uip-inline-flex uip-text-s uip-padding-left-xxs uip-padding-right-xxs uip-border uip-border-round uip-background-muted uip-text-normal"},ie={class:"inline-flex uip-text-muted"},ne={class:"inline-flex uip-text-muted"},ae={class:"uip-padding-xs uip-flex uip-flex-column uip-text-weight-normal"},se={key:0,class:"uip-border-top uip-margin-top-xs uip-margin-bottom-xs"},oe={class:""},ue=["onClick"],re={class:""},me={__name:"index",setup(pe){const{__:a}=wp.i18n,C=l([]),y=l(!0),D=l(null),j=H(),g=l(null),f=l(null),{appContext:L}=G(),r=l({search:"",per_page:30,page:1,total:0,pages:0,status:"any",context:"edit"}),F=l([{key:"name",label:a("Name","uipress-lite")},{key:"status",label:a("Status","uipress-lite")},{key:"type",label:a("Type","uipress-lite")},{key:"modified",label:a("Modified","uipress-lite")},{key:"actions",width:"30px"}]),M=A(()=>[{name:a("Edit","uipress-lite"),icon:"edit",type:"link",url:`/uibuilder/${f.value}`},{name:a("Duplicate","uipress-lite"),icon:"content_copy",type:"action",action:()=>q(f.value)},{type:"divider"},{name:a("Delete","uipress-lite"),icon:"delete",type:"action",action:()=>z(f.value),danger:!0}]),x=async i=>{i||(y.value=!0);let t=new FormData;t.append("action","uip_get_ui_templates"),t.append("security",uip_ajax.security),t.append("page",r.value.page),t.append("search",r.value.search),t.append("filter","all");const e=await h(uip_ajax.ajax_url,t);y.value=!1,e&&(C.value=e.templates)},P=()=>{r.value.page>1&&(r.value.page--,x(!0))},S=()=>{r.value.page<r.value.pages&&(r.value.page++,x(!0))},$=(i,t)=>{const e=w.value[t];e&&j.push(`/uibuilder/${e.id}`)},E=i=>i=="publish"?a("Published","uipress-lite"):a("Draft","uipress-lite"),w=A(()=>{const i=r.value.search.toLowerCase();return C.value.filter(t=>t.name.toLowerCase().includes(i))}),R=(i,t)=>{const e=w.value[t];e&&(f.value=e.id,g.value.show(i))},I=()=>{let i=document.querySelector('link[href*="load-styles.php?"]');if(!i||i.href.includes("admin-bar,"))return;const t=i.href.replace("admin-menu,","admin-menu,admin-bar,"),e=document.createElement("link");e.href=t,e.setAttribute("rel","stylesheet");const o=()=>{i.remove(),e.removeEventListener("load",o)},d=document.head;d.firstChild?d.insertBefore(e,d.firstChild):d.appendChild(e),e.addEventListener("load",o)},q=async i=>{const{uipApp:t}=L.config.globalProperties;let e=new FormData;e.append("action","uip_duplicate_ui_template"),e.append("security",uip_ajax.security),e.append("id",i);const o=await h(uip_ajax.ajax_url,e);if(o.error){t.notifications.notify(o.message,"","error",!0);return}t.notifications.notify(a("Template duplicated","uipress-lite"),"","success",!0),x(!0)},z=async i=>{await D.value.show({title:a("Delete template","uipress-lite"),message:a("Deleted templates can't be recovered","uipress-lite"),okButton:a("Delete","uipress-lite")})&&V(i)},V=async i=>{const{uipApp:t}=L.config.globalProperties;let e=new FormData;e.append("action","uip_delete_ui_template"),e.append("security",uip_ajax.security),e.append("templateids",i);const o=await h(uip_ajax.ajax_url,e);if(o.error){t.notifications.notify(o.message,"","error",!0);return}t.notifications.notify(o.message,"","success",!0),x(!0)},N=async i=>{let t=new FormData;t.append("action","uip_create_new_ui_template"),t.append("security",uip_ajax.security),t.append("templateType",i);const e=await h(uip_ajax.ajax_url,t);e&&j.push(`/uibuilder/${e.id}/`)},U=i=>{i.action(),g.value.close()};return window.parent&&window.parent.postMessage({eventName:"uip_exit_fullscreen"},"*"),x(),I(),(i,t)=>{const e=k("AppIcon"),o=k("RouterLink"),d=k("contextmenu");return m(),_(b,null,[c(J,{pagination:r.value,columns:F.value,data:w.value,fetching:y.value,onPrevious:P,onNext:S,rowClick:$,rowRightClick:R,hideSelect:!0},{"right-actions":p(()=>[s("button",{class:"uip-button-primary uip-flex uip-flex-row uip-gap-xxs uip-flex-center uip-text-s",onClick:t[0]||(t[0]=n=>N("ui-template"))},u(v(a)("New template","uipress-lite")),1)]),empty:p(()=>[s("div",K,[c(e,{icon:"folder_open",style:{"font-size":"60px"}}),s("div",O,u(v(a)("No templates yet","uipress-lite")),1),s("div",Q,u(v(a)("When you create new templates they will show up here.","uipress-lite")),1),s("button",{class:"uip-button-primary uip-flex uip-flex-row uip-gap-xxs uip-flex-center uip-text-s",onClick:t[1]||(t[1]=n=>N("ui-template"))},u(v(a)("New template","uipress-lite")),1)])]),"row-name":p(({row:n})=>[s("div",ee,u(n.name),1)]),"row-status":p(({row:n})=>[s("div",{class:B(["uip-inline-flex uip-text-s uip-padding-left-xxs uip-padding-right-xxs uip-border uip-border-round",n.status==="publish"?"uip-border-green uip-text-green":"uip-border-orange uip-text-orange"])},u(E(n.status)),3)]),"row-type":p(({row:n})=>[s("div",te,u(n.type),1)]),"row-modified":p(({row:n})=>[s("div",ie,u(n.modified),1)]),"row-actions":p(({row:n})=>[s("div",ne,[c(e,{icon:"more_horiz",onClick:W(T=>{f.value=n.id,g.value.show(T)},["stop","prevent"])},null,8,["onClick"])])]),_:1},8,["pagination","columns","data","fetching"]),c(d,{ref_key:"templateContextMenu",ref:g},{default:p(()=>[s("div",ae,[(m(!0),_(b,null,X(M.value,n=>(m(),_(b,null,[n.type=="divider"?(m(),_("div",se)):n.type=="link"?(m(),Y(o,{key:1,to:n.url,class:"uip-link-muted uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder uip-no-underline"},{default:p(()=>[s("span",oe,u(n.name),1),c(e,{icon:n.icon,class:"uip-icon"},null,8,["icon"])]),_:2},1032,["to"])):(m(),_("a",{key:2,onClick:T=>U(n),class:B(["uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder uip-no-underline",n.danger?"uip-link-danger":"uip-link-muted"])},[s("span",re,u(n.name),1),c(e,{icon:n.icon,class:"uip-icon"},null,8,["icon"])],10,ue))],64))),256))])]),_:1},512),c(Z,{ref_key:"confirmModal",ref:D},null,512)],64)}}};export{me as default};
