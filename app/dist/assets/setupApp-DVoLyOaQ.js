import{e as _,N as b,f as y,o as i,g as s,q as v,j as c,k as f,l as p,F as o,E as g,y as l,z as w,m,D as A,O as T,P as N,Q as C,R as P,U as D,V as E,W}from"./index-eeS_Y43W.js";const L={components:{Notify:b},props:{},data(){return{template:{display:"prod",notifications:[],settings:null,content:null,globalSettings:null,updated:null,id:null},loading:!1,updateAvailable:!1,windowWidth:window.innerWidth}},provide(){return{uiTemplate:this.template}},created(){this.initiateApp()},mounted(){this.mountEventListeners()},beforeUnmount(){window.removeEventListener("resize",this.handleWindowResize),document.removeEventListener("uipress/app/page/load/finish",this.getNotifications,{once:!1}),document.removeEventListener("uipress/app/darkmode/toggle",this.toggleDarkMode,{once:!1})},computed:{returnThemeStyles(){return this.isObject(this.uipApp.data.themeStyles)?this.uipApp.data.themeStyles:{}},returnTemplateJS(){if(!(typeof this.template.globalSettings.options>"u"))return this.hasNestedPath(this.template,"globalSettings","options","advanced","js")},returnTemplateCSS(){if(!(typeof this.template.globalSettings.options>"u"))return this.hasNestedPath(this.template,"globalSettings","options","advanced","css")},returnResponsiveClass(){if(this.windowWidth>=990)return"uip-desktop-view";if(this.windowWidth>=699)return"uip-tablet-view";if(this.windowWidth<699)return"uip-phone-view"},isLoading(){return this.loading}},methods:{initiateApp(){this.template.settings=this.uipParseJson(JSON.stringify(uipUserTemplate.settings)),this.template.content=this.uipParseJson(JSON.stringify(uipUserTemplate.content)),this.template.globalSettings=this.uipParseJson(JSON.stringify(uipUserTemplate.settings)),this.template.updated=this.uipParseJson(uipUserTemplate.updated),this.template.id=uipUserTemplate.id,this.loading=!1},mountEventListeners(){window.addEventListener("resize",this.handleWindowResize),document.addEventListener("uipress/app/page/load/finish",this.getNotifications,{once:!1}),document.addEventListener("uipress/app/darkmode/toggle",this.toggleDarkMode,{once:!1}),this.template.globalSettings.type=="ui-template"&&setInterval(this.checkForUpdates,6e4)},handleWindowResize(){this.windowWidth=window.innerWidth},toggleDarkMode(){const e=this.uipApp.data.userPrefs.darkTheme;this.uipApp.data.userPrefs.darkTheme=!e;const t=e?"light":"dark";document.documentElement.setAttribute("data-theme",t);const r=document.querySelectorAll("iframe");if(r){for(const u of r){const d=u.contentWindow.document.documentElement;d&&d.setAttribute("data-theme",t)}this.saveUserPreference("darkTheme",!e,!1)}},getNotifications(){const e=document.querySelector(".uip-page-content-frame");let t;if(t=(e?e.contentWindow.document:document).querySelectorAll(".notice:not(#message):not(.inline):not(.update-message),.wp-analytify-notification"),!t)return;this.template.notifications=[];let u=!1;JSON.stringify(this.template.content).includes("site-notifications")&&(u=!0);for(const a of t)this.template.notifications.push(a.outerHTML.replace("uip-framed-page=1","")),u&&a.setAttribute("style","display:none !important; visibility: hidden !important; opacity: 0 !important;");this.uipApp.data.dynamicOptions.notificationCount.value=this.template.notifications.length},async checkForUpdates(){if(this.updateAvailable)return;let e=new FormData;e.append("action","uip_check_for_template_updates"),e.append("security",uip_ajax.security),e.append("template_id",this.template.id);const t=await this.sendServerRequest(uip_ajax.ajax_url,e);t.success&&t.updated>this.template.updated&&(this.updateAvailable=!0,this.updateNotification())},updateNotification(){let e=__("Changes have been made to your current app. Refresh the page to update","uipress-lite");this.uipApp.notifications.notify(__("Update available","uipress-lite"),e,"",!0)},componentExists(e){return!!this.$root._.appContext.components[e]}}};function U(e,t,r,u,d,a){const k=y("Notify"),S=y("uip-content-area");return i(),s(o,null,[v(k),(i(),c(m("style"),{scoped:"",id:"mycustomstyles"},{default:f(()=>[p(" html, #uip-admin-page, #uip-ui-interface { "),(i(!0),s(o,null,g(a.returnThemeStyles,(n,h)=>(i(),s(o,null,[n.value&&n.value!="uipblank"?(i(),s(o,{key:0},[p(l(h)+":"+l(n.value)+";",1)],64)):w("",!0)],64))),256)),p(' } [data-theme="dark"], .uip-dark-mode, #uip-admin-page .uip-dark-mode, #uip-ui-interface .uip-dark-mode { '),(i(!0),s(o,null,g(a.returnThemeStyles,(n,h)=>(i(),s(o,null,[n.darkValue&&n.darkValue!="uipblank"?(i(),s(o,{key:0},[p(l(h)+":"+l(n.darkValue)+";",1)],64)):w("",!0)],64))),256)),p(" } "+l(a.returnTemplateCSS),1)]),_:1})),(i(),c(m("script"),{scoped:""},{default:f(()=>[p(l(a.returnTemplateJS),1)]),_:1})),(i(),c(m("style"),null,{default:f(()=>[p(" .v-enter-active, .v-leave-active {transition: opacity 0.6s ease;} .v-enter-from, .v-leave-to {opacity: 0;} ")]),_:1})),v(S,{content:d.template.content,class:A(a.returnResponsiveClass)},null,8,["content","class"]),(i(!0),s(o,null,g(e.uipGlobalPlugins,n=>(i(),c(m(n)))),256))],64)}const J=_(L,[["render",U]]);wp.i18n;const R=e=>{const t=T(J);N(t),C(t),P(t,"prod"),D(t),E(t),W(t);const r=document.querySelector(e);r.classList.contains("uip-teleport")&&document.body.appendChild(r),t.mount(e)};export{R as s};
