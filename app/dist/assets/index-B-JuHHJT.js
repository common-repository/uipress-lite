const __vite__fileDeps=["assets/index-DV2SW0ST.js","assets/index-eeS_Y43W.js","builder.build.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{e as b,f as m,o as l,g as d,q as _,t as r,y as g,x as A,B as k,C as D,F as v,z as y,E as j,j as x,$ as T,m as O,_ as K}from"./index-eeS_Y43W.js";import{g as V}from"./index-B5biZt4y.js";import{_ as L}from"./index-DJ_q6T8N.js";import"./fonts-CcfgmNTE.js";import"../builder.build.js";const{__:o}=wp.i18n,C={data(){return{loading:!0,validating:!1,userKey:"",activated:!1,URL:"https://api.uipress.co/",menuWatcher:[],strings:{licence:o("Licence","uipress-lite"),noValidKey:o("Please enter a valid licence key","uipress-lite"),activate:o("Activate","uipress-lite"),validatingKey:o("Validating key","uipress-lite"),licenceActive:o("Licence active","uipress-lite"),removeKey:o("Remove","uipress-lite"),removingKey:o("Removing key","uipress-lite"),help:o("If you have a valid uipress pro key, add it here.","uipress-lite")}}},mounted(){this.getData()},methods:{async validateLicenceKey(){if(!this.userKey){this.uipApp.notifications.notify(this.strings.noValidKey,"","error",!0);return}const t=this.uipApp.notifications.notify(this.strings.validatingKey,"","default",!1,!0);this.validating=!0;let e=this.uipApp.data.options.domain,n="";n+="?k="+this.userKey,n+="&d="+e,n+="&instance=";let i=this.URL+"validate/"+n,s=new FormData;const a=await this.sendServerRequest(i,s);a.error?(this.validating=!1,this.uipApp.notifications.notify(a.message,"","error",!0)):a instanceof Error?(this.validating=!1,this.uipApp.notifications.notify(o("Check failed","uipress-pro"),o("Unable to contact licencing servers. Please try again later","uipress-pro"),"error",!0)):a.state=="false"?(this.validating=!1,this.uipApp.notifications.notify(a.message,"","error",!0)):a.state=="true"?(this.sp=!1,this.validating=!1,this.activated=!0,this.uipApp.notifications.notify(o("Thank you!","uipress-pro"),o("Your key is valid and you can now use pro features","uipress-pro"),"success",!0),this.saveData(this.userKey,a),this.saveUserPreference("uipfa",2,!1),this.userKey=""):(this.validating=!1,this.uipApp.notifications.notify(o("Check failed","uipress-pro"),o("Something went wrong. Please try again later","uipress-pro"),"error",!0)),this.uipApp.notifications.remove(t)},async saveData(t,e){const n="instance_id"in e?e.instance_id:!1;let i=new FormData;i.append("action","uip_save_uip_pro_data"),i.append("security",uip_ajax.security),i.append("key",t),i.append("instance",n),i.append("multisite",this.uipApp.data.options.multisite),i.append("networkActivated",this.uipApp.data.options.networkActivated),i.append("primarySite",this.uipApp.data.options.primarySite);const s=await this.sendServerRequest(uip_ajax.ajax_url,i);if(s.error){this.uipApp.notifications.notify(s.message,"","error",!0);return}},async getData(){this.loading=!0;let t=new FormData;t.append("action","uip_get_pro_app_data"),t.append("security",uip_ajax.security);const e=await this.sendServerRequest(uip_ajax.ajax_url,t);if(this.loading=!1,e.error){this.uipApp.notifications.notify(e.message,"","error",!0),this.activated=!1;return}if(!e.uip_pro){this.activated=!1;return}this.activated=!0,this.userData=e.uip_pro},removeData(){const t=this.uipApp.notifications.notify(this.strings.removingKey,"","default",!1,!0);let e=new FormData;e.append("action","uip_remove_uip_pro_data"),e.append("security",uip_ajax.security),this.sendServerRequest(uip_ajax.ajax_url,e),this.uipApp.notifications.remove(t),this.uipApp.notifications.notify(o("Key successfully removed","uipress-pro"),"","success",!0),this.activated=!1}}},q={key:0,class:"uip-w-100p uip-flex uip-flex-middle uip-flex-center uip-padding-s"},I={key:1,class:"uip-grid-col-4-6",style:{"grid-gap":"var(--uip-margin-m)"}},R={class:"uip-flex uip-flex-column uip-gap-xxs"},F={class:"uip-text-emphasis"},U={class:"uip-text-muted"},N=["value"],P={key:1,class:"uip-flex uip-gap-xs uip-flex-no-wrap uip-flex-start"},E={class:"uip-background-green-wash uip-text-green uip-text-bold uip-border-rounder uip-text-s uip-padding-xs uip-flex uip-flex-column uip-row-gap-xs uip-flex-grow uip-text-center"};function B(t,e,n,i,s,a){const c=m("loading-chart"),f=m("AppIcon");return s.loading?(l(),d("div",q,[_(c)])):(l(),d("div",I,[r("div",R,[r("span",F,g(s.strings.licence),1),r("div",U,g(s.strings.help),1)]),s.activated?(l(),d("div",P,[r("div",E,g(s.strings.licenceActive),1),r("button",{onClick:e[2]||(e[2]=h=>a.removeData()),class:"uip-button-primary uip-text-s uip-flex uip-gap-xxs uip-flex-center"},[_(f,{icon:"close",class:"uip-icon uip-text-muted uip-text-l uip-text-inverse"}),r("span",null,g(s.strings.removeKey),1)])])):(l(),d("form",{key:0,class:"uip-flex uip-gap-xs uip-flex-no-wrap",autocomplete:"off",onSubmit:e[1]||(e[1]=A((...h)=>a.validateLicenceKey&&a.validateLicenceKey(...h),["prevent"]))},[k(r("input",{class:"uip-input-small uip-w-100p",type:"password","onUpdate:modelValue":e[0]||(e[0]=h=>s.userKey=h),placeholder:"xxxx-xxxx-xxxx-xxxx"},null,512),[[D,s.userKey]]),r("input",{type:"submit",class:"uip-button-primary uip-text-s",value:s.strings.activate},null,8,N)],32))]))}const G=b(C,[["render",B]]),{__:u}=wp.i18n,M=T(()=>K(()=>import("./index-DV2SW0ST.js"),__vite__mapDeps([0,1,2]))),J={components:{globalVariables:V,LicenceManager:G,Tabs:L,CodeEditor:M},data(){return{loading:!1,globalSettings:{},search:"",render:!0,activeTab:"general",ui:{strings:{siteSettings:u("Site settings","uipress-lite"),saveSettings:u("Save settings","uipress-lite"),settingsSaved:u("Settings saved","uipress-lite"),proOption:u("This is a pro option. Upgrade to unlock","uipress-lite"),searchSettings:u("Search settings","uipress-lite"),licence:u("Licence","uipress-lite")}}}},created(){this.getSettings()},watch:{"uiTemplate.globalSettings":{handler(t,e){},deep:!0},"uiTemplate.globalSettings":{handler(t,e){},deep:!0}},computed:{proPluginActivated(){let t=this.uipApp.data.options.activePlugins;return t=this.isObject(t)?Object.values(t):t,t.includes("uipress-pro/uipress-pro.php")},returnTabs(){let t={};for(let e in this.uipApp.data.globalGroupOptions)t[e]={label:this.uipApp.data.globalGroupOptions[e].label,value:e};return t}},methods:{async getSettings(){this.loading=!0;let t=new FormData;t.append("action","uip_get_global_settings"),t.append("security",uip_ajax.security);const e=await this.sendServerRequest(uip_ajax.ajax_url,t);if(this.loading=!1,e.error){this.uipApp.notifications.notify(e.message,"","error",!0);return}await this.getUserStyles(),e.options&&this.isObject(e.options)&&Object.keys(e.options).length>0&&(this.globalSettings=e.options)},async getUserStyles(){let t=new FormData;t.append("action","uip_get_ui_styles"),t.append("security",uip_ajax.security);const e=await this.sendServerRequest(uip_ajax.ajax_url,t);e.error||e.styles&&(this.uipApp.data.themeStyles={...this.uipApp.data.themeStyles,...e.styles})},returnTemplateOption(t,e){let n=e.uniqueKey,i=this.globalSettings;if(t in i||(i[t]={}),n in i[t])return i[t][n];switch(e.accepts){case String:i[t][n]="";break;case Array:i[t][n]=[];break;case Object:i[t][n]={};break;case Boolean:i[t][n]=!1;break}return i[t][n]},saveTemplateOption(t,e,n){let i=this.globalSettings;i[t][e]=n},async saveSettings(){let t=this.prepareJSON(this.globalSettings),e=new FormData;e.append("action","uip_save_global_settings"),e.append("security",uip_ajax.security),e.append("settings",t);const n=await this.sendServerRequest(uip_ajax.ajax_url,e);if(n.error){this.uipApp.notifications.notify(n.message,"","error",!0);return}this.uipApp.notifications.notify(this.ui.strings.settingsSaved,"","success",!0)},conditionalShowGroup(t){return"condition"in t?t.condition(this.globalSettings):!0},inSearch(t){const e=this.search.toLowerCase(),n=t.label.toLowerCase(),i=t.help.toLowerCase();return!!(n.includes(e)||i.includes(e))},exportSettings(){const t=JSON.stringify({uipSettings:this.globalSettings}),e=new Date,i=`uip-site-settings-${`${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}-${e.getFullYear()}`}.json`,s=`data:text/json;charset=utf-8,${encodeURIComponent(t)}`,a=this.$refs.exporter;a.setAttribute("href",s),a.setAttribute("download",i),a.click();const c=u("Settings exported","uipress-lite");this.uipApp.notifications.notify(c,"","success",!0)},importSettings(t){const e=this.uipApp.notifications.notify(u("Importing settings","uipress-lite"),"","default",!1,!0),i=t.target.files[0],s=c=>{this.uipApp.notifications.notify(c,"","error",!0,!1),this.uipApp.notifications.remove(e)};if(i.type!=="application/json")return s(u("Settings must be in valid JSON format","uipress-lite"));if(i.size>1e6)return s(u("Uploaded file is too big","uipress-lite"));const a=new FileReader;a.readAsText(i,"UTF-8"),a.onload=c=>{try{const f=JSON.parse(c.target.result);if(!f||!f.uipSettings||!this.isObject(f.uipSettings))return s(u("Settings mismatch","uipress-lite"));this.globalSettings=f.uipSettings,this.uipApp.notifications.notify(u("Settings imported","uipress-lite"),"","success",!0,!1),this.uipApp.notifications.remove(e),this.render=!1,this.$nextTick(()=>{this.render=!0})}catch{s(u("JSON parse failed","uipress-lite"))}}}}},z={class:"uip-flex uip-flex-column uip-w-100p uip-max-h-100p uip-flex-no-wrap uip-row-gap-m uip-padding-top-s"},Y={class:"uip-flex uip-flex-between uip-flex-center"},W={class:"uip-text-l uip-text-emphasis"},$={class:"uip-flex uip-gap-xs"},H={class:"uip-hidden",ref:"exporter"},Q={class:"uip-button-default"},X={class:"uip-flex-grow uip-flex uip-flex-column uip-row-gap-s uip-padding-left-xs uip-padding-right-xs",style:{overflow:"auto"}},Z={class:"uip-flex uip-flex-column uip-row-gap-m"},ee=r("div",{class:"uip-border-top"},null,-1),te={key:0,class:"uip-grid-col-4-6",style:{"grid-gap":"var(--uip-margin-m)"}},ie={class:"uip-flex uip-flex-column uip-gap-xxs"},se={class:"uip-text-emphasis"},ae={class:"uip-text-muted"},ne={class:"uip-w-100p"},re={key:0,href:"https://uipress.co?utm_source=uipressupgrade&utm_medium=referral",target:"_BLANK",class:"uip-padding-xxs uip-border-round uip-background-green-wash uip-text-s uip-link-default uip-no-underline uip-w-100p uip-text-center uip-flex"},oe=r("div",{class:"uip-border-top"},null,-1);function pe(t,e,n,i,s,a){const c=m("AppIcon"),f=m("Tabs"),h=m("LicenceManager"),S=m("globalVariables");return l(),d("div",z,[r("div",Y,[r("div",W,g(s.ui.strings.siteSettings),1),r("div",$,[r("button",{class:"uip-button-default",onClick:e[0]||(e[0]=p=>a.exportSettings())},[_(c,{class:"uip-icon",icon:"download"})]),r("a",H,null,512),r("label",Q,[_(c,{icon:"upload",class:"uip-icon"}),r("input",{hidden:"",accept:".json",type:"file",single:"",id:"uip-import-layout",onChange:e[1]||(e[1]=p=>a.importSettings(p))},null,32)]),r("button",{class:"uip-button-primary",onClick:e[2]||(e[2]=p=>a.saveSettings())},g(s.ui.strings.saveSettings),1)])]),_(f,{options:a.returnTabs,modelValue:s.activeTab,"onUpdate:modelValue":e[3]||(e[3]=p=>s.activeTab=p),class:"uip-margin-bottom-s"},null,8,["options","modelValue"]),r("div",X,[r("div",Z,[a.proPluginActivated&&s.activeTab=="general"?(l(),d(v,{key:0},[_(h),ee],64)):y("",!0),(l(!0),d(v,null,j(t.uipApp.data.globalGroupOptions[s.activeTab].settings,p=>(l(),d(v,null,[a.conditionalShowGroup(p)?(l(),d("div",te,[r("div",ie,[r("span",se,g(p.label),1),r("div",ae,g(p.help),1)]),r("div",ne,[p.proOption?(l(),d("a",re,g(s.ui.strings.proOption),1)):(l(),x(O(p.component),{key:1,value:a.returnTemplateOption(t.uipApp.data.globalGroupOptions[s.activeTab].name,p),args:p.args,returnData:w=>{a.saveTemplateOption(t.uipApp.data.globalGroupOptions[s.activeTab].name,p.uniqueKey,w)}},null,8,["value","args","returnData"]))])])):y("",!0),oe],64))),256)),s.activeTab=="theme"?(l(),x(S,{key:1})):y("",!0)])])])}const ge=b(J,[["render",pe]]);export{ge as default};
